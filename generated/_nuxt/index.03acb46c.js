import{s as A,a as I}from"./datatable.esm.0846d39f.js";import{s as j}from"./button.esm.641ff260.js";import{s as F}from"./card.esm.b0f598a3.js";import L from"./checkbox.esm.532d4a9c.js";import{s as q}from"./dialog.esm.9efea6fc.js";import{i as V,J as f,q as z,l as R,r as m,c as v,b as a,w as o,j as n,k as w,o as d,F as x,m as C,d as J,a as B,s as K,t as O}from"./entry.bebea34a.js";import"./basecomponent.esm.8d6823c6.js";import"./baseicon.esm.142279c1.js";import"./index.esm.deaeaad8.js";import"./dropdown.esm.9630f639.js";import"./index.esm.837f2f1a.js";import"./index.esm.b8edffb5.js";import"./overlayeventbus.esm.8fe2a6c7.js";import"./portal.esm.6db6dad0.js";import"./virtualscroller.esm.65ca7179.js";import"./inputnumber.esm.35080186.js";import"./index.esm.24ac3c77.js";import"./inputtext.esm.c8867acd.js";import"./index.esm.b421671d.js";import"./index.esm.c5c5faa3.js";import"./index.esm.3ecb5efd.js";const u=()=>{const l=V("users",()=>[]);return{users:l,getUsers:async(r="")=>{const{data:s}=await f("api/users",{params:{search:r}});l.value=s.value},deleteUser:async r=>{await f("api/users/"+r,{method:"DELETE"}),l.value.splice(l.value.findIndex(s=>s.id===r),1)},syncRoles:async(r,s)=>{await f("api/users/"+s+"/sync_roles",{method:"POST",body:{roles:r}}),await z().getUser()}}},$=()=>{const l=V("roles",()=>[]);return{roles:l,getRoles:async(y="")=>{const{data:p}=await f("api/roles");l.value=p.value}}},G=B("h1",null,"Korisnici",-1),H=["for"],ve={__name:"index",setup(l){const _=R(()=>u().users.value);u().getUsers();const y=i=>{u().deleteUser(i)},p=(i,t)=>{u().syncRoles(i,t),u().getUsers(),s.value=!1},r=R(()=>$().roles.value),s=m(!1),c=m([]),h=m({});$().getRoles();const E=i=>{c.value=i.roles.map(t=>t.id),h.value=i,s.value=!0},S=m([{field:"name",header:"Naziv",sortable:!1},{field:"email",header:"Email",sortable:!1}]);return(i,t)=>{const g=A,b=j,D=I,U=F,N=L,T=q;return d(),v("div",null,[a(U,{class:"px-10"},{title:o(()=>[G]),content:o(()=>[a(D,{value:n(_),class:"p-datatable-sm",tableStyle:"min-width: 50rem"},{header:o(()=>[]),default:o(()=>[(d(!0),v(x,null,C(n(S),e=>(d(),K(g,{key:e.field,field:e.field,header:e.header,sortable:e.sortable},null,8,["field","header","sortable"]))),128)),a(g,{header:"Akcije"},{body:o(e=>[a(b,{icon:"pi pi-lock",onClick:k=>E(e.data)},null,8,["onClick"]),a(b,{icon:"pi pi-trash",severity:"danger",onClick:k=>y(e.data.id)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])]),_:1}),a(T,{visible:n(s),"onUpdate:visible":t[2]||(t[2]=e=>w(s)?s.value=e:null),modal:"",header:"Uloge korisnika",style:{width:"50vw"}},{default:o(()=>[a(U,{class:"px-10"},{content:o(()=>[(d(!0),v(x,null,C(n(r),e=>(d(),v("div",{key:e.id,class:"flex align-items-center"},[a(N,{modelValue:n(c),"onUpdate:modelValue":t[0]||(t[0]=k=>w(c)?c.value=k:null),inputId:e.id,name:"role",value:e.id},null,8,["modelValue","inputId","value"]),B("label",{for:e.id},O(e.name),9,H)]))),128))]),footer:o(()=>[a(b,{severity:"info",onClick:t[1]||(t[1]=e=>p(n(c),n(h).id))},{default:o(()=>[J(" Spremi ")]),_:1})]),_:1})]),_:1},8,["visible"])])}}};export{ve as default};
